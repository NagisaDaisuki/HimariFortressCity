---
title: Cä¸æŒ‡é’ˆç¬”è®°_7-9 
date: 2025-09-24
tags: [C]
pinned: false
head:
  - - meta
    - name: description
      content: Function Array C_String(char [])
  - - meta
    - name: keywords
      content: å‡½æ•°å®šä¹‰ å‡½æ•°è§„åˆ™ é»‘ç›’ä¸ç™½ç›’ æ¨¡å—ä¸æ¥å£ é€’å½’ä¸è¿­ä»£ å¯å˜å‚æ•°åˆ—è¡¨ ä¸€ç»´æ•°ç»„ä¸äºŒç»´æ•°ç»„ æ•°ç»„ä¸æŒ‡é’ˆä¼˜åŒ– æ•°ç»„é•¿åº¦ æ•°ç»„ å­—ç¬¦ä¸²å¸¸é‡ å­—ç¬¦ä¸²å˜é‡ å­—ç¬¦ä¸²è¾“å…¥è¾“å‡º å­—ç¬¦ä¸²æ“ä½œå‡½æ•° å­—ç¬¦ä¸²è§„åˆ™ å­—ç¬¦ä¸²ä¸å­—ç¬¦å‡½æ•°æ“ä½œ å†…å­˜æ“ä½œå‡½æ•°
---

å­©å­ä»¬è¿™ç®€ç›´å°±æ˜¯Cè¯­è¨€çš„ä¸‰åº§åŸºç¡€å¤§å±±

---

# ğŸ˜  å‡½æ•°

## 7.1 å‡½æ•°å®šä¹‰

- å‡½æ•°çš„å®šä¹‰å°±æ˜¯**å‡½æ•°ä½“çš„å®ç°**:
- å‡½æ•°ä½“å°±æ˜¯ä¸€ä¸ª**ä»£ç å—**ï¼Œå®ƒåœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶æ‰§è¡Œ:

~~~shell
ç±»å‹
å‡½æ•°å( å½¢å¼å‚æ•° )
ä»£ç å—

function_name()
{

}
~~~

**å­˜æ ¹(stub)**ï¼šä¸ºé‚£äº›æ­¤æ—¶å°šæœªå®ç°çš„ä»£ç ä¿ç•™ä¸€ä¸ªä½ç½®ã€‚

> **K&R C**å½¢å‚å£°æ˜

~~~shell
int *
find_int(key, array, array_len)
int key;
int array[];
int array_len;
{}
~~~

**returnè¯­å¥**

- returnè¯­å¥å…è®¸ä»å‡½æ•°ä½“çš„*ä»»ä½•ä½ç½®*è¿”å›ã€‚
- return expressionä¸­çš„`expression`æ˜¯å¯é€‰çš„ã€‚
- é€šå¸¸ï¼Œè¡¨è¾¾å¼çš„ç±»å‹å°±æ˜¯å‡½æ•°å£°æ˜çš„è¿”å›ç±»å‹ã€‚

> æ²¡æœ‰è¿”å›å€¼æˆ–`return;`çš„å‡½æ•°ç±»å‹åº”è¯¥è®¾ç½®ä¸ºvoidå‡½æ•°ã€‚
>> å‡½æ•°è¢«åˆ†ä¸ºæœ‰è¿”å›å€¼çš„å‡½æ•°(**çœŸå‡½æ•°**)å’Œæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°(**è¿‡ç¨‹æˆ–å‰¯ä½œç”¨**)ã€‚

## 7.2 å‡½æ•°å£°æ˜

- ä½¿ç”¨ ***å‡½æ•°åŸå‹(function prototype)*** ä¸ºç¼–è¯‘å™¨æä¾›å‡½æ•°çš„å®Œæ•´ä¿¡æ¯:
- å¯¹äº*K&R C*é£æ ¼å‡½æ•°ç¼–è¯‘å™¨åªçŸ¥é“å‡½æ•°è¿”å›å€¼ç±»å‹:

> æ ‡å‡†è¡¨ç¤ºï¼Œåœ¨åŒä¸€ä¸ªä»£ç å—ä¸­ï¼Œå‡½æ•°åŸå‹å¿…é¡»ä¸**åŒä¸€ä¸ªå‡½æ•°**çš„**ä»»ä½•å…ˆå‰åŸå‹**åŒ¹é…ã€‚

### 7.2.2 å‡½æ•°çš„ç¼ºçœè®¤å®š

- æ— æ³•è§åˆ°åŸå‹çš„å‡½æ•°ï¼Œç¼–è¯‘å™¨è®¤ä¸ºè¯¥å‡½æ•°è¿”å›å€¼ä¸ºæ•´æ•°ç±»å‹ã€‚

## 7.3 å‡½æ•°çš„å‚æ•°

- Cå‡½æ•°çš„æ‰€æœ‰å‚æ•°å‡ä»¥ **"ä¼ å€¼è°ƒç”¨"** æ–¹å¼è¿›è¡Œä¼ é€’ï¼Œå³ä¼ é€’å‚æ•°çš„å‰¯æœ¬ã€‚
- ä¼ é€’æŒ‡é’ˆå’Œæ•°ç»„çš„è¡Œä¸ºå®é™…ä¸Šä¸º **"ä¼ å€è°ƒç”¨"** ã€‚

> å¯¹æŒ‡é’ˆå’Œæ•°ç»„è¿›è¡Œ*é—´æ¥è®¿é—®æ“ä½œ*ã€‚

**ç¼ºçœå‚æ•°æå‡**ï¼šä½¿ç”¨K&R Cæ—§é£æ ¼çš„å½¢å‚ç±»å‹*ç±»ä¼¼char å’Œ shortç±»å‹*ä¼šè¢«æå‡ä¸º`int`ç±»å‹,*floatç±»å‹*ä¼šè¢«æå‡ä¸º`double`ç±»å‹

## 7.4 ADTå’Œé»‘ç›’

- Cè¯­è¨€å¯ä»¥ç”¨äºè®¾è®¡å’Œå®ç°**æŠ½è±¡æ•°æ®ç±»å‹(ADT, Abstract Data Type)**ï¼Œå› ä¸ºå®ƒå¯ä»¥***é™åˆ¶***å‡½æ•°å’Œæ•°æ®å®šä¹‰çš„ä½œç”¨åŸŸã€‚

- **æŠ½è±¡æ•°æ®ç±»å‹(ADT, Abstract Data Type)** æ˜¯ä¸€ç§ç¼–ç¨‹æ¦‚å¿µï¼Œå®ƒå°†æ•°æ®çš„è¡¨ç¤º(å¦‚ä½•å­˜å‚¨)å’Œå¯¹æ•°æ®çš„æ“ä½œ(å¦‚ä½•ä½¿ç”¨)åˆ†ç¦»å¼€æ¥ã€‚

### ADTçš„æ ¸å¿ƒæ€æƒ³

1. **æ•°æ®éšè—(Data Hiding)**ï¼šæ•°æ®çš„å…·ä½“å­˜å‚¨æ–¹å¼è¢«éšè—èµ·æ¥ï¼Œå¤–éƒ¨ä»£ç æ— æ³•ç›´æ¥è®¿é—®æˆ–ä¿®æ”¹ã€‚

2. **æ¥å£(Interface)**ï¼šADTæä¾›ä¸€ç»„æ˜ç¡®å®šä¹‰çš„å…¬å…±å‡½æ•°ï¼Œä½œä¸ºä¸å¤–éƒ¨ä¸–ç•Œçš„å”¯ä¸€äº¤äº’æ–¹å¼ã€‚

- é™åˆ¶å¯¹æ¨¡å—çš„è®¿é—®æ˜¯é€šè¿‡åˆç†ä½¿ç”¨`static`å…³é”®å­—æ¥å®ç°çš„ï¼Œå®ƒå¯ä»¥é™åˆ¶å¯¹é‚£äº›å¹¶éæ¥å£çš„å‡½æ•°å’Œæ•°æ®çš„è®¿é—®ã€‚

### ç¤ºä¾‹ï¼šä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨æ¨¡å—

`counter.h`(å…¬å…±æ¥å£)

è¿™æ˜¯æ¨¡å—çš„â€å¯¹å¤–åˆåŒâ€œï¼Œå®ƒåªå£°æ˜äº†å…¶ä»–æ–‡ä»¶å¯ä»¥è®¿é—®çš„å…¬å…±å‡½æ•°ã€‚

~~~shell
#ifndef COUNTER_H
#define COUNTER_H

// Increment the counter by 1.
void increment_counter(void);

// Get the current value of the counter. 
int get_counter(void);
#endif // COUNTER_H
~~~

`counter.c`(é»‘ç›’å®ç°)

è¿™æ˜¯æ¨¡å—çš„â€å†…éƒ¨é»‘ç›’â€œã€‚`static`å…³é”®å­—ä½¿å¾—`count`å˜é‡å’Œ`private_helper`å‡½æ•°æ— æ³•è¢«å…¶ä»–æ–‡ä»¶ç›´æ¥è®¿é—®ã€‚

~~~shell
#include "counter.h"
#include <stdio.h>
// This is a static variable. Its value is kept for the lifetime of the program,
// but it is only visible and accessible within this file (counter.c).
static int count = 0;

// This is a static function. It's a private helper and cannot be called
// from outside this file.
static void private_helper()
{
  printf("--- (Internal) The counter is now being updated... ---\n");
}

// Public API function. It calls the private helper function
void increment_counter()
{
  private_helper(); // This is allowed bacause private_helper is in the same file.
  count++;
}

// Public API function. It returns the value of the private variable.
int get_counter()
{
  return count;
}
~~~

`main.c`(ä½¿ç”¨æ¨¡å—)

è¿™ä¸ªæ–‡ä»¶åªèƒ½é€šè¿‡`counter.h`ä¸­å£°æ˜çš„å…¬å…±å‡½æ•°ä¸`counter.c`äº¤äº’ã€‚ä»»ä½•è¯•å›¾è®¿é—®å†…éƒ¨ç§æœ‰å‡½æ•°çš„è¡Œä¸ºéƒ½å°†å¯¼è‡´ç¼–è¯‘æˆ–é“¾æ¥é”™è¯¯ã€‚

~~~shell
#include <stdio.h>
#include "counter.h"

int main()
{
  printf("Initial counter value: %d\n",get_counter());
  
  // Call the public function to increment the counter.
  increment_counter();
  printf("Counter value after first increment: %d\n", get_counter());

  increment_counter();
  printf("Counter value after second increment: %d\n", get_counter());

  // COMPILE/LINK ERROR!
  // The linker will fail because private_helper() is not a public symbol.
  // private_helper(); 

  return 0; 
}
~~~

> å¦‚æœä¸åŒ…å«æœ€åä¸€è¡Œ`private_helper()`çš„è°ƒç”¨ç¨‹åºå°†ç¼–è¯‘å’Œé“¾æ¥æˆåŠŸã€‚

## 7.5 é€’å½’

- é€’å½’å‡½æ•°å°±æ˜¯ç›´æ¥æˆ–é—´æ¥è°ƒç”¨è‡ªèº«çš„å‡½æ•°ã€‚
- Cé€šè¿‡**è¿è¡Œæ—¶å †æ ˆ**æ”¯æŒé€’å½’å‡½æ•°çš„å®ç°ã€‚
- é€’å½’çš„æ•ˆç‡å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½éå¸¸ä½ã€‚

### ä½¿ç”¨é€’å½’ä¸è¿­ä»£æ¥è¡¨ç¤ºé˜¶ä¹˜çš„è®¡ç®—

~~~shell
factorial(n) =
â”œâ”€â”€ n <= 0 : 1
â””â”€â”€ n > 0 : n x factorial(n - 1)
~~~

**é€’å½’æ–¹æ³•**

~~~shell
long 
factorial(int n)
{
  if (n <= 0)
    return 1;
  else 
    return n * factorial(n - 1);
}
~~~

**è¿­ä»£æ–¹æ³•**

~~~shell
long
factorial(int n)
{
  int result = 1;
  while (n > 1)
  { 
    result *= n;
    n -= 1;
  }
  
  return result;
}
~~~

> è®¸å¤šé—®é¢˜æ˜¯ä»¥é€’å½’çš„å½¢å¼è¿›è¡Œè§£é‡Šçš„ï¼Œè¿™åªæ˜¯å› ä¸ºå®ƒæ¯”éé€’å½’å½¢å¼æ›´ä¸ºæ¸…æ™°ï¼Œä½†æ˜¯è¿™äº›é—®é¢˜çš„è¿­ä»£å®ç°å¾€å¾€æ¯”é€’å½’å®ç°æ•ˆç‡æ›´é«˜ã€‚

### ä½¿ç”¨é€’å½’ä¸è¿­ä»£æ¥è¡¨ç¤ºæ–æ³¢é‚£å¥‘æ•°

~~~shell
Fibonacci(n) =
â”œâ”€â”€ n <= 1 : 1 
â”œâ”€â”€ n = 2 : 1
â”œâ”€â”€ n > 2 : Fibonacci(n - 1) +Fibonacci(n - 2)
~~~

**é€’å½’æ–¹æ³•**

~~~shell
long fibonacci(int n)
{
  if (n <= 2)
    return 1;

  return fibonacci(n - 1) + fibonacci(n - 2);
}
~~~

**è¿­ä»£æ–¹æ³•**

~~~shell
long fibonacci(int n)
{
  long result;
  long previous_result;
  long next_older_result;
  
  result = previout_result = 1;
  
  if (n <= 2)
    return 1;
  
  while (n > 2)
  {
    n -= 1;
    next_older_result = previous_result;
    previous_result = result;
    result = previous_result + next_older_result;
  }
}
~~~

> ä½¿ç”¨é€’å½’å®ç°æ–æ³¢é‚£å¥‘æ•°çš„ä»£ä»·æ¯”ä½ è¿œæƒ³çš„è¦å¤§ã€‚

## 7.6 å¯å˜å‚æ•°åˆ—è¡¨

- ä½¿ç”¨`stdarg`å®å®ç°å¯å˜å‚æ•°åˆ—è¡¨ï¼Œè¿™äº›å®å®šä¹‰åœ¨`stdarg.h`å¤´æ–‡ä»¶
- åœ¨å®šä¹‰å¯å˜å‚æ•°åˆ—è¡¨æ—¶åœ¨çœç•¥å·å‰ä¸€å®šæ˜¯ä»£è¡¨åé¢å¯å˜å‚æ•°åˆ—è¡¨**å‚æ•°ä¸ªæ•°**

è¿™ä¸ªå¤´æ–‡ä»¶å£°æ˜äº†ä¸€ä¸ªç±»å‹`va_list`å’Œ3ä¸ªå®---`va_start`ã€`va_arg`å’Œ`va_end`

### è®¡ç®—æ ‡é‡å‚æ•°å¹³å‡å€¼(éå¯å˜å‚æ•°)

~~~shell
float average(int n_values, int v1,int v2, int v3, int v4, int v5)
{
  float sum = v1; 
  
  if ( n_values >= 2)
    sum += v2;
  if ( n_values >= 3 )
    sum += v3;
  if ( n_values >= 4 )
    sum += v4;
  if ( n_values >= 5 )
    sum += v5;

  return sum / n_values;
}
~~~

### è®¡ç®—æ ‡é‡å‚æ•°å¹³å‡å€¼(å¯å˜å‚æ•°)

~~~shell
#include <stdarg.h>

float average(int n_values, ...) // ä¼ é€’ä»»æ„æ•°é‡çš„æœªçŸ¥æ•°
{
  va_list var_arg;
  int count;
  float sum;
  
  // å‡†å¤‡è®¿é—®å¯å˜å‚æ•°
  va_start (var_arg, n_values);
  
  // æ·»åŠ å–è‡ªå¯å˜å‚æ•°åˆ—è¡¨çš„å€¼
  for (count = 0;count < n_values;count += 1)
    sum += va_arg(var_arg, int);
  
  // å®Œæˆå¤„ç†å¯å˜å‚æ•°
  va_end(var_arg);
  
  return sum / n_values;
}
~~~

# ğŸ– æ•°ç»„

## 8.1 ä¸€ç»´æ•°ç»„

- **æŒ‡é’ˆä¸æ•°ç»„å¹¶ä¸æ˜¯ç›¸ç­‰çš„ã€‚**

### 8.1.1 æ•°ç»„å

è€ƒè™‘ä¸‹é¢çš„è¿™äº›å£°æ˜:

~~~shell
int a;
int b[10];
~~~

> aä¸ºæ ‡é‡ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå•ä¸€çš„å€¼ï¼›bä¸ºæ•°ç»„ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€äº›å€¼çš„é›†åˆã€‚

**æ•°ç»„**: ç›¸åŒç±»å‹çš„å€¼çš„é›†åˆã€‚

> int b[10]ä¸­çš„bå¹¶ä¸è¡¨ç¤ºæ•´ä¸ªæ•°ç»„è€Œæ˜¯è¡¨ç¤ºæ•°ç»„é¦–ä¸ªå…ƒç´ çš„åœ°å€ã€‚æ•°ç»„ä¸º`int`ç±»å‹è¡¨ç¤ºæ•°ç»„åçš„ç±»å‹ä¸º"æŒ‡å‘intçš„å¸¸é‡æŒ‡é’ˆ"ã€‚

- åŒºåˆ†æŒ‡é’ˆä¸æ•°ç»„å·®åˆ«çš„å…¶ä¸­ä¸€ä¸ªç†ç”±æ˜¯æ•°ç»„åæ˜¯**æŒ‡é’ˆå¸¸é‡**è€Œä¸æ˜¯**æŒ‡é’ˆå˜é‡**ã€‚

> å¸¸é‡çš„å€¼æ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å¦‚æœæœ‰ä¸€ä¸ªæŒ‡é’ˆ`int *c`é‚£ä¹ˆb = cè¿™ç§èµ‹å€¼æ˜¯éæ³•çš„ï¼Œå› ä¸ºbæ˜¯å¸¸é‡ã€‚

### 8.1.2 ä¸‹æ ‡å¼•ç”¨

- **é™¤ä¼˜å…ˆçº§å¤–ï¼Œä¸‹æ ‡å¼•ç”¨å’Œé—´æ¥è®¿é—®å®Œå…¨ç›¸åŒã€‚**

~~~shell
array[subscript] == *(array + (subscript))
~~~

**è¯æ˜ç›¸ç­‰æ€§:**

~~~shell
int array[10];
int *ap = array + 2;
~~~

|statement|expression|
|:----:|:---:|
|ap|array + 2 and &array[2]|
|*ap|array[2] and *(array + 2)|
|ap[0]|*(ap + 0) and array[2]|
|ap+6|array + 8 and &array[8]|
|*ap+6|array[2] + 6|
|*(ap+6)|array[8]|
|ap[6]|*(ap+6)|
|&ap|**unpredictable**|
|ap[-1]|**correct operation and its array[1]**|
|ap[9]|**unpredictable**|

> **åç§»é‡çš„è´Ÿæ•°æ˜¯å¯ä»¥å…è®¸çš„**

æœ€åä¸¤ä¸ªä¾‹å­æ˜¾ç¤ºäº†ä¸ºä»€ä¹ˆ**ä¸‹æ ‡æ£€æŸ¥**åœ¨Cä¸­æ˜¯ä¸€é¡¹å›°éš¾çš„ä»»åŠ¡ã€‚æœ€åˆçš„Cç¼–è¯‘å™¨å¹¶ä¸æ£€æŸ¥ä¸‹æ ‡ï¼Œè€Œæœ€æ–°çš„ç¼–è¯‘å™¨æœ‰äº›ä¾ç„¶ä¸æ£€æŸ¥ä¸‹æ ‡ã€‚ä¸”å¦‚æœç¼–è¯‘å™¨è¿›è¡Œä¸‹æ ‡æ£€æŸ¥æ¶‰åŠçš„å¼€é”€æ¯”æƒ³è±¡çš„å¤šã€‚

> 2[array] æ˜¯ä¸€ä¸ª**åˆæ³•**çš„æ•°ç»„è¡¨ç¤ºï¼å®ƒè¡¨ç¤ºçš„æ˜¯ *(2 + array)ï¼Œä¹Ÿå°±æ˜¯*(array + 2)å³array[2]ã€‚

### 8.1.3 æŒ‡é’ˆä¸ä¸‹æ ‡

- å¦‚æœå¯ä»¥äº’æ¢åœ°ä½¿ç”¨æŒ‡é’ˆè¡¨è¾¾å¼å’Œä¸‹æ ‡è¡¨è¾¾å¼ï¼Œä¸‹æ ‡ç»ä¸ä¼šæ¯”æŒ‡é’ˆæ›´æœ‰æ•ˆç‡ï¼ŒæŒ‡é’ˆè¡¨è¾¾å¼æœ‰æ—¶å€™æ¯”ä¸‹æ ‡è¡¨è¾¾å¼**æ›´æœ‰æ•ˆç‡**ã€‚

**ä¸‹æ ‡æ–¹æ¡ˆæ‰§è¡Œå¾ªç¯**

~~~shell
int array[10],a;
for (a = 0;a < 10;a++)
  array[a] = 0;
~~~

**æŒ‡é’ˆé—´æ¥è®¿é—®æ–¹æ¡ˆæ‰§è¡Œå¾ªç¯**

~~~shell
int array[10],*ap;
for (ap = array;ap < array + 10;ap++)
  *ap = 0;
~~~

- åœ¨æ¯”è¾ƒè€çš„ç¼–è¯‘å™¨ä¸­æŒ‡é’ˆé—´æ¥è®¿é—®æ¯”ä¸‹æ ‡è®¿é—®æ›´æœ‰æ•ˆç‡  

**1. æ•°ç»„ä¸‹æ ‡ç‰ˆæœ¬**  
å¯¹äº`array[a] = 0;`è¿™è¡Œä»£ç ï¼Œè®¡ç®—æœºåœ¨æ¯æ¬¡å¾ªç¯æ—¶éƒ½å¿…é¡»åšä»¥ä¸‹ä¸‰ä»¶äº‹ï¼š  
a. æ‰¾åˆ°æ•°ç»„çš„èµ·å§‹åœ°å€(`array`);  
b. å°†å¾ªç¯å˜é‡`a`ä¹˜ä»¥`int`ç±»å‹çš„å¤§å°(ä¾‹å¦‚å››å­—èŠ‚)ï¼›  
c. å°†ç›¸ä¹˜çš„ç»“æœ**åŠ åˆ°**èµ·å§‹åœ°å€ï¼Œæ‰èƒ½æ‰¾åˆ°`array[a]`çš„å‡†ç¡®å†…å­˜ä½ç½®ã€‚

> è¿™ä¸ªè¿‡ç¨‹åœ¨æ¯æ¬¡å¾ªç¯ä¸­éƒ½æ¶‰åŠ**ä¸€æ¬¡ä¹˜æ³•å’Œä¸€æ¬¡åŠ æ³•**ã€‚

**2. æŒ‡é’ˆé—´æ¥è®¿é—®ç‰ˆæœ¬**  
å¯¹äº`*ap = 0;`è¿™è¡Œä»£ç ï¼Œè®¡ç®—æœºçš„å¤„ç†æ–¹æ³•æ›´ç›´æ¥ï¼š  
a. æŒ‡é’ˆ`ap`å·²ç»ç›´æ¥å­˜å‚¨äº†å½“å‰è¦æ“ä½œçš„å†…å­˜åœ°å€ã€‚  
b. `*ap`æ“ä½œç›´æ¥è®¿é—®åœ°å€ï¼Œéå¸¸å¿«ã€‚  
c. `ap++`æ“ä½œåªéœ€è¦ç®€å•åœ°åœ¨`ap`çš„åœ°å€ä¸ŠåŠ ä¸Š`int`ç±»å‹çš„å¤§å°(ä¾‹å¦‚å››å­—èŠ‚)ï¼Œå°±èƒ½å¾—åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ çš„åœ°å€ã€‚

> è¿™ä¸ªè¿‡ç¨‹åªæ¶‰åŠ**ä¸€æ¬¡ç®€å•çš„åŠ æ³•**ï¼Œæ¯”ä¹˜æ³•è¦å¿«å¾—å¤šã€‚

- ä½†ç°ä»£ç¼–è¯‘å™¨**éå¸¸æ™ºèƒ½**ï¼Œåƒæ•°ç»„ä¸‹æ ‡ç‰ˆæœ¬ä¼šè¢«**ä¼˜åŒ–æˆæ›´é«˜æ•ˆçš„æŒ‡é’ˆç®—æœ¯æŒ‡ä»¤**ã€‚

### 8.1.4 æŒ‡é’ˆçš„æ•ˆç‡

- ç¨‹åºçš„æ•ˆç‡å–å†³äºä½ çš„**ç¼–è¯‘å™¨**å’Œ**æœºå™¨**ã€‚

æŠŠä¸€ä¸ªæ•°ç»„çš„å†…å®¹å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ•°ç»„ï¼š

~~~shell
#define SIZE 50
int x[SIZE];
int y[SIZE];
int i;
int *p1,*p2;
~~~

ä¸‹æ ‡ç‰ˆæœ¬å‡½æ•°ï¼š

~~~shell
void try1()
{
  for(i = 0; i < SIZE;i++)
    x[i] = y[i];
}
~~~

æŒ‡é’ˆç‰ˆæœ¬å‡½æ•°ï¼š

~~~shell
void try2()
{
    for( p1 = x, p2 = y; p1 - x < SIZE;)
      *p1++ = *p2++;
}
~~~

é‡æ–°ä½¿ç”¨è®¡æ•°å™¨ï¼š

~~~shell
void try3()
{
  for( i = 0; p1 = x, p2 = y; i < SIZE; i++)
  {
    *p1++ = *p2++;
  }
}
~~~

å¯„å­˜å™¨æŒ‡é’ˆå˜é‡ï¼š

~~~shell
void try4()
{
  register int *p1, *p2;
  register int i;
  
  for( i = 0;p1 = x, p2 = y;i < SIZE; i++)
    *p1++ = *p2++;
}
~~~

æ¶ˆé™¤è®¡æ•°å™¨ï¼š

~~~shell
void try5()
{
  register int *p1, *p2;

  for( p1 = x, p2 = y;p1 < &x[SIZE])
  {
    *p1++ = *p2++;
  }
}
~~~

é‡æ–°ä½¿ç”¨è®¡æ•°å™¨æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¸é”™çš„å†™æ³•ï¼Œè€Œæ¶ˆé™¤è®¡æ•°å™¨åˆ™æ˜¯ä¸€ä¸ªæ›´åŠ å¿«é€Ÿçš„æ‰§è¡Œä»£ç ã€‚

**ç»“è®º**:  

1. ä½¿ç”¨æŒ‡é’ˆå˜é‡å°†æ¯”ä½¿ç”¨ä¸‹æ ‡äº§ç”Ÿæ•ˆç‡æ›´é«˜çš„ä»£ç ã€‚å½“è¿™ä¸ªå¢é‡æ˜¯1å¹¶ä¸”æœºå™¨å…·æœ‰åœ°å€è‡ªåŠ¨å¢é‡æ¨¡å‹æ—¶ï¼Œè¿™ç‚¹è¡¨ç°å¾—æ›´ä¸ºçªå‡ºã€‚
2. å¦‚æœæœ‰ç»è¿‡åˆå§‹åŒ–å¹¶ç»è¿‡è°ƒæ•´çš„å†…å®¹æ¥åˆ¤æ–­å¾ªç¯æ˜¯å¦åº”è¯¥ç»ˆæ­¢ï¼Œå°±ä¸éœ€è¦ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„è®¡æ•°å™¨ã€‚
3. é‚£äº›å¿…é¡»åœ¨è¿è¡Œæ—¶æ±‚å€¼çš„è¡¨è¾¾å¼è¯¸å¦‚`&array[SIZE]`æˆ–`array+SIZE`è¿™æ ·çš„å¸¸é‡è¡¨è¾¾å¼å¾€å¾€ä»£ä»·æ›´é«˜ã€‚

### 8.1.5 æ•°ç»„å’ŒæŒ‡é’ˆ

- æŒ‡é’ˆå’Œæ•°ç»„å¹¶ä¸æ˜¯ç›¸ç­‰çš„ã€‚

åœ¨ä½¿ç”¨`int a[10]` å’Œ `int *b`è¿™ä¸¤ä¸ªæŒ‡é’ˆå€¼æ—¶è¡¨è¾¾å¼`*a`æ˜¯åˆæ³•è€Œ`*b`æ˜¯éæ³•çš„ï¼›è¡¨è¾¾å¼`b++`å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œä½†`a++`ä¸è¡Œã€‚

### 8.1.6 ä½œä¸ºå‡½æ•°å‚æ•°çš„æ•°ç»„å

~~~shell
void strcpy(char *buffer, char const *string)
{
  while (*buffer++ = *string++ != '\0');
}
~~~

whileè¯­å¥ä¸­çš„`*string++`è¡¨è¾¾å¼å–å¾—stringæ‰€æŒ‡å‘çš„é‚£ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”äº§ç”Ÿä¸€ä¸ªå‰¯ä½œç”¨ï¼Œå°±æ˜¯ä¿®æ”¹`string`ï¼Œä½¿å®ƒæŒ‡å‘ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ç”¨è¿™ç§æ–¹æ³•ä¿®æ”¹å½¢å‚å¹¶ä¸ä¼šå½±å“è°ƒç”¨ç¨‹åºçš„å®å‚ï¼Œå› ä¸ºåªæœ‰ä¼ é€’ç»™å‡½æ•°çš„é‚£ä»½æ‹·è´è¿›è¡Œäº†ä¿®æ”¹ã€‚

### 8.1.7 å£°æ˜æ•°ç»„å‚æ•°

`int strlen(char * string)`å’Œ`int strlen(char string[])`è¿™ä¸¤ç§å£°æ˜æ˜¯ç›¸ç­‰çš„ï¼Œ**ä½†æ˜¯åªåœ¨å½“å‰è¿™ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒä¸­**ã€‚

- ä½¿ç”¨`char *string`æŒ‡é’ˆå£°æ˜æ•°ç»„å‚æ•°æ›´åŠ å‡†ç¡®ï¼Œä¸”æ•°ç»„ä½œä¸ºå½¢å‚ä¸éœ€è¦ä¼ é€’å…ƒç´ ä¸ªæ•°ï¼Œå› ä¸ºå‡½æ•°å¹¶ä¸ä¸ºæ•°ç»„å‚æ•°åˆ†é…å†…å­˜ç©ºé—´ï¼Œ**å½¢å‚åªæ˜¯ä¸€ä¸ªæŒ‡é’ˆ**ã€‚

### 8.1.8 åˆå§‹åŒ–

`int vector[5] = {10,20,30,40,50};`æ˜¯ä¸€ä¸ªæ ‡å‡†çš„æ•°ç»„åˆå§‹åŒ–ã€‚

#### é™æ€å’Œè‡ªåŠ¨åˆå§‹åŒ–

- æ•°ç»„åˆå§‹åŒ–çš„æ–¹å¼ç±»ä¼¼äºæ ‡é‡å˜é‡çš„åˆå§‹åŒ–æ–¹å¼---ä¹Ÿå°±æ˜¯å–å†³äºå®ƒä»¬çš„å­˜å‚¨ç±»å‹ã€‚
- å­˜å‚¨åœ¨é™æ€å†…å­˜çš„æ•°ç»„åªåˆå§‹åŒ–ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯åœ¨ç¨‹åºå¼€æ‰§è¡Œä¹‹å‰ã€‚
- å¯¹äºè‡ªåŠ¨å˜é‡è€Œè¨€è‡ªåŠ¨å˜é‡ä½äºè¿è¡Œæ—¶å †æ ˆç¼–è¯‘å™¨æ²¡åŠæ³•åœ¨ç¨‹åºå¼€å§‹å‰å¯¹å®ƒè¿›è¡Œåˆå§‹åŒ–ã€‚æ‰€ä»¥è‡ªåŠ¨å˜é‡åœ¨ç¼ºçœæƒ…å†µä¸‹æ˜¯æœªåˆå§‹åŒ–çš„ã€‚

> å½“æ•°ç»„çš„åˆå§‹åŒ–å±€éƒ¨äºä¸€ä¸ªå‡½æ•°(æˆ–ä»£ç å—)æ—¶ï¼Œä½ åº”è¯¥ä»”ç»†è€ƒè™‘ä¸€ä¸‹ï¼Œåœ¨ç¨‹åºçš„æ‰§è¡Œæµæ¯æ¬¡è¿›å…¥è¯¥å‡½æ•°(æˆ–ä»£ç å—)æ—¶ï¼Œæ¯æ¬¡éƒ½å¯¹æ•°ç»„è¿›è¡Œé‡æ–°åˆå§‹åŒ–æ˜¯ä¸æ˜¯å€¼å¾—ã€‚å¦‚æœç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå°±æŠŠæ•°ç»„å£°æ˜ä¸º`static`ï¼Œè¿™æ ·æ•°ç»„çš„åˆå§‹åŒ–åªéœ€åœ¨ç¨‹åºå¼€å§‹å‰æ‰§è¡Œä¸€æ¬¡ã€‚

### 8.1.9 ä¸å®Œæ•´çš„åˆå§‹åŒ–

- åˆå§‹åŒ–å€¼æ•°ç›®å¤§äºæ•°ç»„é•¿åº¦(ç¼–è¯‘æ—¶é”™è¯¯)ï¼›å°äºåˆ™å°†æœªåˆå§‹åŒ–çš„å…ƒç´ åˆå§‹åŒ–ä¸º0ï¼Œä¸”åªå…è®¸çœç•¥æœ€åå‡ ä¸ªåˆå§‹å€¼ã€‚

### 8.1.10 è‡ªåŠ¨è®¡ç®—æ•°ç»„é•¿åº¦

`int vector[] = {1,2,3,4,5};`è®©ç¼–è¯‘å™¨è¯†åˆ«æ•°ç»„å¤§å°

### 8.1.11 å­—ç¬¦æ•°ç»„çš„åˆå§‹åŒ–

ä¸¤ç§åˆå§‹åŒ–æ–¹æ³•ï¼š  
1.`char message[] = {'H','e','l','l','o',0};`  
2.`char message[] = "Hello";`

è¿™ä¸¤ç§åˆå§‹åŒ–æ–¹æ³•æ˜¯ç›¸åŒçš„ï¼Œéƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦æ•°ç»„åˆå§‹åŒ–åˆ—è¡¨ï¼Œè€Œ`char* message = "Hello";`æ˜¯ä¸€ä¸ª**å­—ç¬¦ä¸²å¸¸é‡**ï¼Œå³ä¸€ä¸ªæŒ‡å‘å¸¸é‡å­—ç¬¦ä¸²"Hello"çš„æŒ‡é’ˆã€‚ä¸Šé¢ä¸¤ä¸ªéƒ½æ˜¯å¯ä¿®æ”¹çš„å­—ç¬¦æ•°ç»„ã€‚

## 8.2 å¤šç»´æ•°ç»„

- `int martix[6][10]`åœ¨æŸäº›ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­ï¼Œæ—¢æ˜¯6è¡Œ10åˆ—ï¼Œä¹Ÿæ˜¯10è¡Œ6åˆ—ã€‚

### 8.2.1 å­˜å‚¨é¡ºåº

`int array[4];`æ˜¯ä¸€ä¸ªå­˜å‚¨ä¸‰ä¸ªæ•´å‹å…ƒç´ çš„æ•°ç»„  
`int array[4][6];`åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šå°†ä¸‰ä¸ªæ•´å‹å…ƒç´ æ”¹ä¸ºä¸‰ä¸ªåŒ…å«6ä¸ªå…ƒç´ çš„æ•°ç»„

- åœ¨Cä¸­ï¼Œå¤šç»´æ•°ç»„çš„å…ƒç´ å­˜å‚¨é¡ºåºæŒ‰ç…§æœ€å³è¾¹ä¸‹æ ‡ç‡å…ˆå˜åŒ–çš„åŸåˆ™ç§°ä¸º**è¡Œä¸»åº(row major order)**ã€‚æ¯”å¦‚è¯»å–`array[2][4]`å¾€ä¸‹è¯»å–åº”è¯¥æ˜¯`array[2][5]`åæ˜¯`array[3][0]`ã€‚

### 8.2.2 æ•°ç»„å

- ä¸€ç»´æ•°ç»„åçš„å€¼æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¸¸é‡ï¼Œå®ƒçš„ç±»å‹æ˜¯"æŒ‡å‘å…ƒç´ ç±»å‹çš„æŒ‡é’ˆ"
- å¤šç»´æ•°ç»„å’Œä¸€ç»´æ•°ç»„ä¸ºä¸€ä¸ªåŒºåˆ«æ˜¯å¤šç»´æ•°ç»„çš„ç¬¬ä¸€ç»´å…ƒç´ å®é™…ä¸Šæ˜¯å¦ä¸€ä¸ªæ•°ç»„

`int martix[3][10];`è¿™ä¸ªæ•°ç»„å`matrix`çš„å€¼æ˜¯ä¸€ä¸ªæŒ‡å‘å®ƒç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼Œæ‰€ä»¥`matrix`æ˜¯ä¸€ä¸ªæŒ‡å‘ä¸€ä¸ªåŒ…å«10ä¸ªæ•´å‹çš„æ•°ç»„çš„æŒ‡é’ˆã€‚

### 8.2.3 ä¸‹æ ‡

`matrix`: æŒ‡å‘åŒ…å«10ä¸ªæ•´å‹å…ƒç´ çš„æ•°ç»„çš„æŒ‡é’ˆ  
`matrix+1`: æŒ‡å‘åŒ…å«10ä¸ªæ•´å‹å…ƒç´ çš„æ•°ç»„çš„æŒ‡é’ˆï¼Œä½†æ˜¯æŒ‡å‘çš„æ˜¯matrixçš„ä¸‹ä¸€è¡Œ  
`*(matrix + 1)`: åŒ…å«10ä¸ªæ•´å‹å…ƒç´ çš„å­æ•°ç»„(å¸¸é‡æŒ‡é’ˆ)ï¼Œä¸`matrix[1]`ç›¸ç­‰  
`*(matrix + 1) + 5`: ä¸Šé¢çš„å¸¸é‡æŒ‡é’ˆå³ç§»5ä½  
`*(*(matrix + 1) + 5)`: ä¸Šé¢æŒ‡é’ˆæ‰€æŒ‡å‘çš„å…ƒç´ ï¼Œä¸`matrix[1][5]`å€¼ç›¸ç­‰  
ä¸Šé¢çš„å¼å­å¯ä»¥æ”¹å†™ä¸ºï¼š*(matrix[1] + 5)

### 8.2.4 æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ

~~~shell
int   vector[10], *vp = vector;
int   matrix[3][10], *mp = matrix;
~~~

ç¬¬ä¸€ä¸ªå£°æ˜æ˜¯åˆæ³•çš„ï¼Œç¬¬äºŒä¸ªå£°æ˜æ˜¯éæ³•çš„ã€‚  
`matrix`ä¸æ˜¯ä¸€ä¸ªæŒ‡å‘æ•´å‹çš„æ•°ç»„è€Œæ˜¯ä¸€ä¸ªæŒ‡å‘æ•´å‹æ•°ç»„çš„æŒ‡é’ˆã€‚

`int (*p)[10]`æ˜¯ä¸€ä¸ªåˆæ³•çš„æŒ‡å‘äºŒç»´æ•°ç»„çš„æ•°ç»„æŒ‡é’ˆã€‚å› ä¸ºä¸‹æ ‡å¼•ç”¨çš„ä¼˜å…ˆçº§é«˜äºé—´æ¥è®¿é—®
ï¼Œæ‰€ä»¥è¦ç»™`*p`åŠ ä¸Šæ‹¬å·ã€‚

~~~shell
int *pi = &matrix[0][0];
int *pi = matrix[0];
~~~

ä¸Šé¢çš„ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘äºŒç»´æ•°ç»„çš„é¦–åœ°å€å¯ä»¥é€ä¸ªè®¿é—®æ•´å‹å…ƒç´ è€Œä¸æ˜¯é€è¡Œåœ¨æ•°ç»„ä¸­ç§»åŠ¨
> åº”è¯¥é¿å…ä½¿ç”¨`int  (*p)[] = matrix;`è¿™ç§æ²¡æœ‰æ•°ç»„é•¿åº¦çš„å£°æ˜ï¼Œå› ä¸ºæ²¡æœ‰å£°æ˜æ•°ç»„é•¿åº¦å½“æ‰§è¡ŒæŒ‡é’ˆè¿ç®—æ—¶å®ƒçš„å€¼å°†æ ¹æ®ç©ºæ•°ç»„çš„é•¿åº¦è¿›è¡Œè°ƒæ•´(ä¸0ç›¸ä¹˜)

### 8.2.5 ä½œä¸ºå‡½æ•°å‚æ•°çš„å¤šç»´æ•°ç»„

å¦‚æœæ˜¯äºŒç»´æ•°ç»„ä½ å¯ä»¥å£°æ˜ä¸ºä»¥ä¸‹çš„ä»»æ„ä¸€ä¸ª

~~~shell
void func2(int (*mat)[10]);
void func2(int mat[][10]);
~~~

- ç¼–è¯‘å™¨å¿…é¡»çŸ¥é“**ç¬¬äºŒä¸ª**åŠä»¥åå„ç»´çš„é•¿åº¦æ‰èƒ½å¯¹å„ä¸‹æ ‡è¿›è¡Œæ±‚å€¼ï¼Œå› æ­¤åœ¨åŸå‹ä¸­å¿…é¡»å£°æ˜è¿™äº›ç»´çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯åœ¨åŸæ•°ç»„å£°æ˜æ—¶è‡³å°‘ä¸º`int mat[][10]`è¿™ç§å¹¶ä¸”åœ¨å‡½æ•°å½¢å‚å£°æ˜æ—¶ä¹Ÿå†™æˆè¿™æ ·

`void func2(int **mat);`æ˜¯ä¸€ä¸ªæŒ‡å‘æ•´å‹æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œå’Œä¸€å¼€å§‹è¯´çš„ä¸€æ ·ï¼ŒæŒ‡é’ˆå’Œæ•°ç»„æ˜¯ä¸åŒçš„ï¼Œå’ŒæŒ‡å‘æ•´å‹æ•°ç»„çš„æŒ‡é’ˆä¸æ˜¯ä¸€å›äº‹ã€‚

### 8.2.6 åˆå§‹åŒ–

~~~shell
int matrix[2][3] = {100,101,102,110,111,112};

int two_dim[3][5] = {
  {00,01,02,03,04},
  {00,01,02,03,04},
  {00,01,02,03,04}
};
~~~

ä¸Šé¢ä¸¤ç§åˆå§‹åŒ–çš„æ–¹æ³•éƒ½å¯ä»¥ï¼Œå¯¹äºä¸‰ç»´ä»¥ä¸Šçš„æ•°ç»„æ¥è¯´ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œå’Œä¸€ç»´æ•°ç»„ä¸€æ ·ä¹Ÿå¯ä»¥çœç•¥å°¾éƒ¨çš„å‡ ä¸ªåˆå§‹å€¼ã€‚

## 8.3 æŒ‡é’ˆæ•°ç»„

`int  *api[10];`: ä¸‹æ ‡å¼•ç”¨çš„ä¼˜å…ˆçº§é«˜äºé—´æ¥è®¿é—®ï¼Œåœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¸­é¦–å…ˆæ‰§è¡Œä¸‹æ ‡å¼•ç”¨ã€‚  

ä½¿ç”¨æŒ‡é’ˆæ•°ç»„çš„åœºæ™¯ï¼š

~~~shell
char const *keyword[] = {
    "do",
    "for",
    "register",
    "return",
    "switch",
    "while",
    NULL 
};
#define N_KEYWORD \
  (sizeof(keyword) / sizeof(keyword[0]))

# åˆ¤æ–­å‚æ•°æ˜¯å¦ä¸ä¸€ä¸ªå…³é”®å­—åˆ—è¡¨ä¸­çš„ä»»ä½•å•è¯åŒ¹é…ï¼Œå¹¶è¿”å›åŒ¹é…çš„ç´¢å¼•å€¼ã€‚
# å¦‚æœæœªæ‰¾åˆ°åŒ¹é…å‡½æ•°è¿”å›-1
#include <string.h>

int lookup_keyword( char const* const desired_word, 
              char const *keyword_table[], int const size)
{
  char const **kwp;
  
  // å¯¹äºè¡¨ä¸­çš„æ¯ä¸ªå•è¯ ...
  // for (kwp = keyword_table; kwp < keyword_table + size; kwp++)
  // {
  //   if (strcmp(desired_word, *kwp) == 0)
  //       return kwp - keyword_table;
  // }
  for (kwp = keyword_table; kwp != NULL;kwp++)
  {
    if (strcmp(desired_word, *kwp) == 0)
      return kwp - keyword_table;
  }
  

  // æ²¡æœ‰æ‰¾åˆ°
  return -1;
}

~~~

> ä½¿ç”¨sizeof()å¯¹æ•°ç»„å…ƒç´ ä¸ªæ•°è¿›è¡Œè‡ªåŠ¨è®¡æ•°

## 8.4 æ€»ç»“

1. `sizeof(array)`è¿”å›çš„æ˜¯æ•´ä¸ªæ•°ç»„æ‰€å ç”¨çš„å­—èŠ‚è€Œä¸æ˜¯ä¸€ä¸ªæŒ‡é’ˆæ‰€å ç”¨çš„å­—èŠ‚ã€‚
2. &array å’Œ array æŒ‡å‘çš„åœ°å€ç›¸åŒï¼Œä½†æ˜¯&arrayçš„ç±»å‹ä¸º`int (*)[]`è€Œarrayçš„ç±»å‹ä¸º`int*`
3. å…¶ä»–ä½¿ç”¨æ•°ç»„åçš„åœ°æ–¹æ•°ç»„åéƒ½æ˜¯æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ
4. `æ•°ç»„åœ°å€(ç±»ä¼¼äº&array[1][2]) = æ•°ç»„åŸºåœ°å€ + (è¡Œç´¢å¼• * æ¯è¡Œå¤§å°) + (åˆ—ç´¢å¼• * æ¯è¡Œå¤§å°)`

`åœ°å€ = åŸºåœ°å€ + (è¡Œç´¢å¼• * åˆ—æ•° * å…ƒç´ å¤§å°) + (åˆ—ç´¢å¼• * å…ƒç´ å¤§å°)`

å‡å¦‚`int array[4][2]`,intå¤§å°ä¸º2,arrayçš„åœ°å€ä¸º0x1000ï¼Œåˆ™ &array[1][2] = `0x1000 + (1 * 8) + (2 * 4) == 0x1016`

# ğŸ’ å­—ç¬¦ä¸²ã€å­—ç¬¦å’Œå­—èŠ‚

- å­—ç¬¦ä¸²æ˜¯ä¸€ç§é‡è¦çš„æ•°æ®ç±»å‹ï¼Œä½†æ˜¯Cè¯­è¨€å¹¶æ²¡æœ‰æ˜¾å¼çš„å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œå› ä¸ºå­—ç¬¦ä¸²ä»¥å­—ç¬¦ä¸²å¸¸é‡çš„å½¢å¼å‡ºç°æˆ–è€…å­˜å‚¨äºå­—ç¬¦æ•°ç»„ä¸­ã€‚
- æ“ä½œå­—ç¬¦ä¸²å˜é‡æ—¶å¿…é¡»é¢å¤–å°å¿ƒå„ç§å¯èƒ½å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºçš„æ“ä½œã€‚

## 9.1 å­—ç¬¦ä¸²åŸºç¡€

- å­—ç¬¦ä¸²æ˜¯ä¸€ä¸²**é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦**ï¼Œå¹¶ä¸”ä»¥ä¸€ä¸ª**ä½æ¨¡å¼ä¸ºå…¨0çš„NULå­—ç¬¦ç»“å°¾**ã€‚

> å­—ç¬¦ä¸²æ‰€åŒ…å«çš„å­—ç¬¦å†…éƒ¨ä¸èƒ½å‡ºç°NULå­—èŠ‚
>
## 9.2 å­—ç¬¦ä¸²é•¿åº¦

- å­—ç¬¦ä¸²çš„é•¿åº¦å°±æ˜¯å®ƒæ‰€åŒ…å«çš„å­—ç¬¦ä¸ªæ•°ã€‚

ä½¿ç”¨æ ‡å‡†åº“å¤´æ–‡ä»¶`#include <string.h>`ä¸­çš„å‡½æ•°è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦

~~~shell
strlen åŸå‹
size_t strlen (char const *string);
~~~

> size_t æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œä¸”è¿™ä¸ªç±»å‹æ˜¯åœ¨å¤´æ–‡ä»¶`stddef.h`ä¸­å®šä¹‰çš„

- æ— ç¬¦å·æ•°çš„ä½¿ç”¨éœ€è¦è€ƒè™‘æ˜¯å¦ä¼šäº§ç”Ÿè´Ÿæ•°

~~~shell
if (strlen(x) >= strlen(y)) ...
if (strlen(x) - strlen(y) >= 0) ...
~~~

è¿™ä¸¤ä¸ªå¼å­æ˜¯ä¸ç›¸ç­‰çš„ï¼Œç¬¬äºŒè¡Œçš„`strlen(x) - strlen(y)`çš„è¿”å›ç»“æœæ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•°ï¼Œ**æ— ç¬¦å·æ•°ç»ä¸å¯èƒ½æ˜¯è´Ÿæ•°**ï¼

**strlenåŸå‹**

~~~shell
#include <stddef.h>

size_t 
strlen(char const *string)
{
  int length;
  
  for (length = 0; *string++ != '\0';)
    length += 1;
  return length;
}
~~~

- è¡¨è¾¾å¼ä¸­å¦‚æœåŒæ—¶å­˜åœ¨æ— ç¬¦å·æ•°å’Œæœ‰ç¬¦å·æ•°ï¼Œå¯èƒ½ä¼šäº§ç”Ÿå¥‡æ€ªçš„ç»“æœ

~~~shell
if (strlen(x) >= 10) ...
if (strlen(x) - 10 >= 0) ...
~~~

è¿™ä¸¤ä¸ªå¼å­ä¹Ÿæ˜¯ä¸ç›¸ç­‰çš„ï¼ŒåŸå› å’Œä¸Šé¢ç›¸åŒã€‚
> å¦‚æœæŠŠstrlençš„è¿”å›å€¼å¼ºåˆ¶è½¬æ¢ä¸º`int`ï¼Œå°±å¯ä»¥æ¶ˆé™¤è¿™ä¸ªé—®é¢˜ã€‚

**tips:**
> è‡ªå·±é‡å†™ä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°å¯èƒ½ä¼šæ¯”æ ‡å‡†åº“å‡½æ•°æ•ˆç‡æ›´é«˜ï¼Œå¦‚æœåˆç†ä½¿ç”¨å¯„å­˜å™¨registerå£°æ˜å’Œä¸€äº›æŠ€å·§ï¼Œ**ä½†äº‹å®ä¸Šå¾ˆå°‘èƒ½å¦‚æ„¿**ã€‚
>> <u>å¯»æ‰¾ä¸€ç§æ›´å¥½çš„ç®—æ³•æ¯”æ”¹è‰¯ä¸€ç§å·®åŠ²çš„ç®—æ³•æ›´æœ‰æ•ˆç‡ï¼Œå¤ç”¨å·²ç»å­˜åœ¨çš„è½¯ä»¶æ¯”é‡æ–°å¼€å‘ä¸€ä¸ªæ•ˆç‡æ›´é«˜ã€‚</u>

## 9.3 ä¸å—é™åˆ¶çš„å­—ç¬¦ä¸²å‡½æ•°

- æœ€å¸¸ç”¨çš„å­—ç¬¦ä¸²å‡½æ•°éƒ½æ˜¯**ä¸å—é™åˆ¶**çš„ï¼Œå°±æ˜¯è¯´å®ƒä»¬åªæ˜¯é€šè¿‡å¯»æ‰¾å­—ç¬¦ä¸²å‚æ•°ç»“å°¾çš„`NUL`å­—èŠ‚æ¥åˆ¤æ–­å®ƒçš„é•¿åº¦ã€‚

### 9.3.1 å¤åˆ¶å­—ç¬¦ä¸²

~~~shell
char *strcpy(char *dst, char const *src);
~~~

è¿™ä¸ªå‡½æ•°æŠŠå‚æ•°srcå­—ç¬¦ä¸²å¤åˆ¶åˆ°dstå‚æ•°ï¼Œ<u>ç”±äºdstå‚æ•°å°†è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥å®ƒå¿…é¡»æ˜¯ä¸ªå­—ç¬¦æ•°ç»„æˆ–è€…æ˜¯ä¸€ä¸ªæŒ‡å‘åŠ¨æ€åˆ†é…å†…å­˜çš„æ•°ç»„çš„æŒ‡é’ˆï¼Œ**ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡**</u>

> <u>ç¨‹åºå‘˜å¿…é¡»ä¿è¯ç›®æ ‡å­—ç¬¦æ•°ç»„çš„ç©ºé—´è¶³ä»¥å®¹çº³éœ€è¦å¤åˆ¶çš„å­—ç¬¦ä¸²ã€‚</u>å› ä¸ºå¦‚æœå­—ç¬¦ä¸²æ¯”æ•°ç»„é•¿ï¼Œå¤šä½™çš„å­—ç¬¦ä»ç„¶è¢«å¤åˆ¶ï¼Œå®ƒä»¬å°†è¦†ç›–åŸå…ˆå­˜å‚¨äºæ•°ç»„åé¢çš„å†…å­˜ç©ºé—´çš„å€¼ã€‚
>> strcpyæ— æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒæ— æ³•åˆ¤æ–­ç›®æ ‡å­—ç¬¦æ•°ç»„çš„é•¿åº¦ã€‚

### 9.3.2 è¿æ¥å­—ç¬¦ä¸²

~~~shell
char *strcat( char *dst, char const *src);
~~~

- æ‰¾åˆ°å­—ç¬¦ä¸²æœ«å°¾NULå¹¶å°†srcä¸­çš„é¦–å­—ç¬¦è¦†ç›–æ‰NUL  

å¸¸è§`strcat`ç”¨æ³•

~~~shell
strcpy( message, "Hello ");
strcat( message, customer_name );
strcpy( message, ", how are you?");
~~~

### 9.3.3 å‡½æ•°çš„è¿”å›å€¼

- `strcpy`å’Œ`strcat`éƒ½è¿”å›å®ƒç¬¬ä¸€ä¸ªå‚æ•°çš„ä¸€ä»½æ‹·è´

å°†å‡½æ•°è¿”å›å€¼ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°

~~~shell
strcat(strcpy(dst,a),b);
~~~

> é¦–å…ˆæ‰§è¡Œ`strcpy`å°†å­—ç¬¦ä¸²ä»aå¤åˆ¶åˆ°dstå¹¶è¿”å›dstã€‚ç„¶åè¿™ä¸ªè¿”å›å€¼æˆä¸º`strcat`å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ`strcat`å‡½æ•°æŠŠbæ·»åŠ åˆ°dstçš„åé¢ã€‚

ä½†æ˜¯åœ¨å¯è¯»æ€§ä¸Šå…¶å®ä¸å¦‚

~~~shell
strcpy(dst,a);
strcat(dst,b);
~~~

- äº‹å®ä¸Šï¼Œåœ¨è¿™äº›å‡½æ•°çš„ç»å¤§å¤šæ•°è°ƒç”¨ä¸­å®ƒä»¬çš„è¿”å›å€¼åªæ˜¯è¢«ç®€å•åœ°å¿½ç•¥ã€‚

### 9.3.4 å­—ç¬¦ä¸²æ¯”è¾ƒ

- æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ¶‰åŠå¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²å¯¹åº”çš„å­—ç¬¦é€ä¸ªè¿›è¡Œæ¯”è¾ƒï¼Œç›´åˆ°å‘ç°ä¸åŒ¹é…ä¸ºæ­¢ã€‚
- é‚£ä¸ªæœ€å…ˆä¸åŒ¹é…çš„å­—ç¬¦ä¸­è¾ƒ"å°"(å­—ç¬¦é›†ä¸­åºæ•°è¾ƒå°)çš„é‚£ä¸ªå­—ç¬¦æ‰€åœ¨çš„å­—ç¬¦ä¸²è¢«è®¤ä¸º"å°äº"å¦å¤–ä¸€ä¸ªå­—ç¬¦ä¸²

~~~shell
int strcmp(char const *s1, char const *s2);
~~~

å¦‚æœ`s1`å°äº`s2`ï¼Œstrcmpå‡½æ•°è¿”å›ä¸€ä¸ªå°äºé›¶çš„å€¼ï¼Œåä¹‹è¿”å›ä¸€ä¸ªå¤§äºé›¶çš„å€¼ã€‚ç›¸ç­‰è¿”å›é›¶ã€‚

~~~shell
if (strcmp(a,b)) // ç”¨äºå¸ƒå°”å€¼æµ‹è¯•æ˜¯ä¸€ç§åé£æ ¼
if (strcmp(a,b) > 0) // ç”¨äºä¸é›¶è¿›è¡Œæ¯”è¾ƒæ›´å¥½
else if (strcmp(a,b) < 0)
else
~~~

## 9.4 é•¿åº¦å—é™çš„å­—ç¬¦ä¸²å‡½æ•°

<u>æ ‡å‡†åº“è¿˜åŒ…å«äº†ä¸€äº›å‡½æ•°ï¼Œå®ƒä»¬ä»¥ä¸€ç§ä¸åŒçš„æ–¹å¼å¤„ç†å­—ç¬¦ä¸²ã€‚</u>

~~~shell
char *strncpy(char *dst, char const *src, size_t len);
char *strncat(char *dst, char const *src, size_t len);
char *strncmp(char const *s1, char const *s2, size_t len);
~~~

è¿™äº›å‡½æ•°æ¥å—ä¸€ä¸ªæ˜¾å¼çš„é•¿åº¦å‚æ•°ï¼Œç”¨äº**é™å®š**è¿›è¡Œå¤åˆ¶æˆ–æ¯”è¾ƒçš„å­—ç¬¦æ•°ã€‚

- æ³¨æ„âš ï¸ï¼šå¦‚æœstrlen(src)çš„å€¼å¤§äºæˆ–ç­‰äºlenï¼Œ<u>é‚£ä¹ˆåªæœ‰lenä¸ªå­—ç¬¦è¢«å¤åˆ¶åˆ°dstä¸­ã€‚å®ƒçš„ç»“æœå°†ä¸ä¼šä»¥**NUL**å­—èŠ‚ç»“å°¾ã€‚</u>

> strncpy è°ƒç”¨çš„ç»“æœå¯èƒ½ä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› æ­¤å­—ç¬¦ä¸²å¿…é¡»ä»¥NULå­—èŠ‚ç»“å°¾ã€‚

ä¿è¯strncpyçš„ç»“æœæ˜¯ä»¥'\0'ç»“å°¾çš„

~~~shell
char buffer[BSIZE];
...
strncpy(buffer, name, BSIZE);
buffer[BSIZE - 1] = '\0';
~~~

å¦‚æœnameçš„å†…å®¹å¯ä»¥å®¹çº³äºbufferä¸­æœ€åçš„èµ‹å€¼è¯­å¥æ— æ•ˆã€‚

å¦‚æœstrlen(name) >= BSIZE é‚£ä¹ˆæœ€åä¸€æ¡èµ‹å€¼è¯­å¥å¯ä»¥æˆªæ–­nameçš„å­—ç¬¦é˜²æ­¢ç¼“å­˜åŒºæº¢å‡ºã€‚

> strncatæ€»æ˜¯åœ¨ç»“æœå­—ç¬¦ä¸²åé¢æ·»åŠ ä¸€ä¸ªNULå­—èŠ‚ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰è¿™ç§é—®é¢˜ï¼›strncmpåªæ¯”è¾ƒlené•¿åº¦çš„å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœstrlen(name)æ¯”BSIZEå¤§åˆ™åªæ¯”è¾ƒBSIZEé•¿åº¦ä¸ªå­—ç¬¦ã€‚

## 9.5 å­—ç¬¦ä¸²æŸ¥æ‰¾åŸºç¡€

### 9.5.1 æŸ¥æ‰¾ä¸€ä¸ªå­—ç¬¦

~~~shell
char *strchr(char const *str, int ch);
char *strrchr(char const *str, int ch);
~~~

> è™½ç„¶chæ˜¯`int`ç±»å‹ä½†æ˜¯åŒ…å«ä¸€ä¸ªå­—ç¬¦å€¼ã€‚

- `strchr`åœ¨å­—ç¬¦ä¸²strä¸­æŸ¥æ‰¾å­—ç¬¦chç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œæ‰¾åˆ°åå‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥ä½ç½®çš„æŒ‡é’ˆï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸å­˜åœ¨åˆ™è¿”å›NULLæŒ‡é’ˆã€‚strrchrè¿”å›ä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚

~~~shell
char string[20] = "Hello there, honey.";
char *ans;
ans = strchr(string, 'h');
~~~

### 9.5.2 æŸ¥æ‰¾ä»»ä½•å‡ ä¸ªå­—ç¬¦

~~~shell
char *strpbrk(char const *str, char const *group);
~~~

- è¿”å›ä¸€ä¸ªæŒ‡å‘strä¸­ç¬¬ä¸€ä¸ªåŒ¹é…groupä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦çš„å­—ç¬¦ä½ç½®ã€‚å¦‚æœæœªæ‰¾åˆ°åŒ¹é…åˆ™è¿”å›NULLæŒ‡é’ˆã€‚åŒºåˆ†å¤§å°å†™ã€‚

~~~shell
char string[20] = "Hello there, honey.";
char *ans;
ans = strchr(string, "aeiou");
~~~

ansæ‰€æŒ‡å‘çš„ä½ç½®æ˜¯string + 1ï¼Œå› ä¸ºè¿™ä¸ªä½ç½®æ˜¯ç¬¬äºŒä¸ªå‚æ•°ä¸­çš„å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚åŒºåˆ†å¤§å°å†™ã€‚

### 9.5.3 æŸ¥æ‰¾ä¸€ä¸ªå­ä¸²

~~~shell
char *strstr(char const *s1, char const *s2);
~~~

- åœ¨s1ä¸­æŸ¥æ‰¾s2ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥ä½ç½®çš„æŒ‡é’ˆï¼›å¦‚æœs2å¹¶æ²¡æœ‰å®Œå‡ºç°åœ¨s1è¿”å›ä¸€ä¸ªNULLæŒ‡é’ˆï¼›å¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆå‡½æ•°è¿”å›s1ã€‚

#### è‡ªå·±å®ç°ä¸€ä¸ª `strtstr` å’Œ `strrpbrk` å‡½æ•°

~~~shell
#include <string.h>

char*
my_strrstr(char const *s1, char const *s2)
{
  register char *last;
  register char *current;

  // æŠŠæŒ‡é’ˆåˆå§‹åŒ–ä¸ºæˆ‘ä»¬å·²ç»æ‰¾åˆ°çš„å‰ä¸€æ¬¡åŒ¹é…
  last = NULL;
  
  // åªåœ¨ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ä¸ä¸ºç©ºçš„æ—¶å€™è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœs2ä¸ºç©ºè¿”å›NULL
  
  if (*s2 != '\0')
  {
    // æŸ¥æ‰¾ s2 åœ¨ s1 ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚
    current = strstr(s1,s2);
    while (current != NULL)
    {
      last = current;
      current = strstr(last + 1, s2);
    }
  }
  return last; // è¿”å›æŒ‡å‘æˆ‘ä»¬æ‰¾åˆ°çš„æœ€åä¸€æ¬¡åŒ¹é…çš„èµ·å§‹ä½ç½®çš„æŒ‡é’ˆã€‚
}
~~~

~~~shell
#include <string.h>

char *
my_strrpbrk(char const *str, char const *group)
{
  register char *last;
  register char current;
  
  // æŠŠæŒ‡é’ˆåˆå§‹åŒ–ä¸ºæˆ‘ä»¬å·²ç»æ‰¾åˆ°çš„å‰ä¸€æ¬¡åŒ¹é…
  last = NULL;
  
  if (*s2 != '\0')
  {
    current = strpbrk(str, group);
    while (current != NULL)
    {
      last = current;
      current = strpbrk(last + 1, group);
    }
  }
  return last;
}
~~~

## 9.6 é«˜çº§å­—ç¬¦ä¸²æŸ¥æ‰¾

### 9.6.1 æŸ¥æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²å‰ç¼€

- `strspn`å’Œ`strcspn`å‡½æ•°ç”¨äºè®¡ç®—å­—ç¬¦ä¸²å¼€å¤´è¿ç»­åŒ¹é…æŒ‡å®šå­—ç¬¦é›†ä¸­çš„å­—ç¬¦çš„ä¸ªæ•°

~~~shell
size_t strspn(char const *str, char const *group);
size_t strcspn(char const *str, char const *group);
~~~

`str`: è¦æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚  
`group`ï¼šåŒ…å«è¦åŒ¹é…çš„å­—ç¬¦é›†çš„å­—ç¬¦ä¸²ã€‚

>`strspn` ä» `str1` çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¾æ¬¡æ£€æŸ¥æ¯ä¸ªå­—ç¬¦ã€‚åªè¦è¿™ä¸ªå­—ç¬¦åœ¨ `str2` ä¸­èƒ½æ‰¾åˆ°ï¼Œå°±ç»§ç»­å‘åæ£€æŸ¥ã€‚**ä¸€æ—¦é‡åˆ°ä¸€ä¸ªä¸åœ¨ `str2` ä¸­çš„å­—ç¬¦ï¼Œå‡½æ•°å°±åœæ­¢å¹¶è¿”å›å·²åŒ¹é…çš„å­—ç¬¦æ•°ã€‚**

> `strcspn` ä» `str1` çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¾æ¬¡æ£€æŸ¥æ¯ä¸ªå­—ç¬¦ã€‚åªè¦è¿™ä¸ªå­—ç¬¦ä¸åœ¨ `str2` ä¸­ï¼Œå°±ç»§ç»­å‘åæ£€æŸ¥ã€‚ä¸€æ—¦é‡åˆ°ä¸€ä¸ªåœ¨ `str2` ä¸­çš„å­—ç¬¦ï¼Œå‡½æ•°å°±åœæ­¢å¹¶è¿”å›å·²æ£€æŸ¥çš„å­—ç¬¦æ•°ã€‚

~~~shell
#include <stdio.h>
#include <string.h>

int main() {
    const char *sentence = "Hello, world!";
    const char *charset_vowels = "aeiou";
    const char *charset_alpha = "abcdefghijklmnopqrstuvwxyz";

    size_t length1 = strspn(sentence, "Heo");
    printf("The length of the initial part of \"%s\" consisting of 'H', 'e', 'o' is: %zu\n", sentence, length1); 
    // è¾“å‡º: 2 (å› ä¸º 'l' ä¸åœ¨ "Heo" ä¸­)

    size_t length2 = strspn(sentence, charset_alpha);
    printf("The length of the initial part of \"%s\" consisting of letters is: %zu\n", sentence, length2);
    // è¾“å‡º: 5 (å› ä¸º ' ' ä¸åœ¨å­—æ¯è¡¨ä¸­)

    return 0;
}
~~~

### 9.6.2 æŸ¥æ‰¾æ ‡è®°

- `strtok`å‡½æ•°ç”¨äºåˆ†å‰²å­—ç¬¦ä¸²ã€‚å®ƒä¼šæ ¹æ®æŒ‡å®šçš„åˆ†éš”ç¬¦ï¼Œå°†å­—ç¬¦ä¸²åˆ†è§£æˆä¸€ç³»åˆ—çš„æ ‡è®°(token)ã€‚

~~~shell
char *strtok(char *str, char const *sep);
~~~

`str`ï¼šè¦è¢«åˆ†å‰²çš„å­—ç¬¦ä¸²ã€‚
`sep`ï¼šåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†éš”ç¬¦çš„å­—ç¬¦ä¸²ã€‚

> strtokæ˜¯åœ¨å­—ç¬¦ä¸²æœ¬èº«è¿›è¡Œå¤„ç†çš„(in-place)ï¼Œå»ºè®®ä½¿ç”¨åŸå­—ç¬¦ä¸²çš„æ‹·è´è¿›è¡Œæ“ä½œã€‚

- `strtok`çš„ä½¿ç”¨éå¸¸ç‰¹æ®Šï¼Œå› ä¸ºå®ƒæ˜¯æœ‰çŠ¶æ€çš„ï¼š
  - ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼šä¼ å…¥è¦åˆ†å‰²çš„å­—ç¬¦ä¸²`str`ã€‚å®ƒä¼šæ‰¾åˆ°ç¬¬ä¸€ä¸ªåˆ†éš”ç¬¦ï¼Œç”¨`\0`æ›¿æ¢å®ƒï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªæ ‡è®°çš„æŒ‡é’ˆã€‚
  - åç»­è°ƒç”¨ï¼šä¼ å…¥`NULL`ä½œä¸º`str`å‚æ•°ã€‚`strtok`ä¼šä»ä¸Šæ¬¡åœæ­¢çš„ä½ç½®ç»§ç»­ï¼Œæ‰¾åˆ°ä¸‹ä¸€ä¸ªåˆ†éš”ç¬¦ï¼Œç”¨`\0`æ›¿æ¢å®ƒï¼Œå¹¶è¿”å›ä¸‹ä¸€ä¸ªæ ‡è®°çš„æŒ‡é’ˆã€‚

~~~shell
#include <stdio.h>
#include <string.h>

int main(void)
{
  char str[] = "apple,banana-orange";
  const char *delimiters = ",-";
  char *token;

  // ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œ ä¼ å…¥å­—ç¬¦ä¸²
  token = strtok(str,delimiters);
  printf("First token: %s\n", token);
  
  // åç»­è°ƒç”¨ï¼Œä¼ å…¥NULL
  while(token != NULL)
  {
    token = strtok(NULL,delimiters);
    if (token != NULL){
      printf("Next token: %s\n",token);
    }
  }
  return 0;
}
~~~

## 9.7 é”™è¯¯ä¿¡æ¯

- å½“ä½ è°ƒç”¨ä¸€äº›å‡½æ•°ï¼Œè¯·æ±‚æ“ä½œç³»ç»Ÿæ‰§è¡Œä¸€äº›åŠŸèƒ½å¦‚æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œå¦‚æœå‡ºç°é”™è¯¯ï¼Œæ“ä½œç³»ç»Ÿæ˜¯é€šè¿‡è®¾ç½®ä¸€ä¸ªå¤–éƒ¨çš„æ•´å‹å˜é‡`errno`è¿›è¡Œé”™è¯¯ä»£ç æŠ¥å‘Šçš„ã€‚`strerror`å‡½æ•°æŠŠå…¶ä¸­ä¸€ä¸ªé”™è¯¯ä»£ç ä½œä¸ºå‚æ•°å¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘ç”¨äºæè¿°é”™è¯¯çš„å­—ç¬¦ä¸²çš„æŒ‡é’ˆã€‚

~~~shell
char *stderror(int error_number);
~~~

äº‹å®ä¸Šï¼Œè¿”å›å€¼åº”è¯¥è¢«å£°æ˜ä¸º`const`ï¼Œå› ä¸ºä½ ä¸åº”è¯¥ä¿®æ”¹å®ƒã€‚

- `strerror`å‡½æ•°ç”¨äºå°†é”™è¯¯ç¼–å·è½¬æ¢ä¸ºäººç±»å¯è¯»çš„é”™è¯¯ä¿¡æ¯å­—ç¬¦ä¸²ã€‚

~~~shell
#include <stdio.h>
#include <string.h>
#include <errno.h>
// å¿…é¡»åŒ…å«æ­¤å¤´æ–‡ä»¶æ¥ä½¿ç”¨ errno

int main(void)
{
  FILE *file;
  // å°è¯•æ‰“å¼€ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶
  file = fopen("non_existent_file.txt", "r");
  
  // å¦‚æœ fopen å¤±è´¥
  if (file == NULL)
    printf("Error opening file: %s\n", strerror(errno));
  else
  {
    printf("File opened successfully.\n");
    fclose(file);
  }
  return 0;
}
~~~

## 9.8 å­—ç¬¦æ“ä½œ

- å­—ç¬¦æ“ä½œçš„åŸå‹ä½äº`ctype.h`å¤´æ–‡ä»¶ä¸­ï¼Œåˆ†ä¸ºå­—ç¬¦åˆ†ç±»å‡½æ•°å’Œå­—ç¬¦è½¬æ¢å‡½æ•°

### 9.8.1 å­—ç¬¦åˆ†ç±»

<h4>å­—ç¬¦åˆ†ç±»å‡½æ•°</h4>

| å‡½æ•° | å¦‚æœå®ƒçš„å‚æ•°ç¬¦åˆä¸‹åˆ—æ¡ä»¶å°±è¿”å›çœŸ |
|:---:|:---:|
|isspace|ç©ºç™½å­—ç¬¦: 'ç©ºæ ¼', æ¢é¡µ'\f'ï¼Œæ¢è¡Œ '\n', å›è½¦ '\r', åˆ¶è¡¨ç¬¦ '\t'æˆ–å‚ç›´åˆ¶è¡¨ç¬¦'\v'|
|isdigit|åè¿›åˆ¶æ•°å­—0~9|
|isxdigit|åå…­è¿›åˆ¶æ•°å­—ï¼ŒåŒ…æ‹¬æ‰€æœ‰åè¿›åˆ¶æ•°å­—ï¼Œå°å†™å­—æ¯a\~f,å¤§å†™å­—æ¯A\~F|
|islower|å°å†™å­—æ¯a~z|
|isupper|å¤§å†™å­—æ¯A~Z|
|isalpha|å­—æ¯a\~z A\~Z|
|isalnum|å­—æ¯æˆ–æ•°å­—ï¼Œa\~z,A\~zæˆ–0~9|
|ispunct|æ ‡ç‚¹ç¬¦å·ï¼Œä»»ä½•ä¸å±äºæ•°å­—æˆ–å­—æ¯çš„å›¾å½¢å­—ç¬¦(å¯æ‰“å°ç¬¦å·)|
|isgraph|ä»»ä½•å›¾å½¢å­—ç¬¦|
|isprint|ä»»ä½•å¯æ‰“å°å­—ç¬¦ï¼ŒåŒ…æ‹¬å›¾å½¢å­—ç¬¦å’Œç©ºç™½å­—ç¬¦|

### 9.8.2 å­—ç¬¦è½¬æ¢

~~~shell
int tolower(int ch);
int toupper(int ch);

if (ch >= 'A' && ch <= 'Z') åœ¨ASCIIå­—ç¬¦é›†çš„æœºå™¨ä¸Šèƒ½å¤Ÿè¿è¡Œï¼Œä½†æ˜¯å…¶ä»–å­—ç¬¦é›†æœ‰å¯èƒ½ä¼šå¤±è´¥
if (isupper(ch))
å°±éƒ½èƒ½é¡ºåˆ©è¿è¡Œ
~~~

## 9.9 å†…å­˜æ“ä½œ

- æ ¹æ®å®šä¹‰ï¼Œå­—ç¬¦ä¸²ç”±ä¸€ä¸ªNULå­—èŠ‚ç»“å°¾ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å†…éƒ¨ä¸èƒ½åŒ…å«ä»»ä½•NULå­—ç¬¦ã€‚ä½†æ˜¯éå­—ç¬¦ä¸²æ•°æ®å†…éƒ¨åŒ…å«é›¶å€¼çš„æƒ…å†µå¹¶ä¸ç½•è§ã€‚ä½ æ— æ³•ä½¿ç”¨å­—ç¬¦ä¸²å‡½æ•°æ¥å¤„ç†è¿™ç§ç±»å‹çš„æ•°æ®ï¼Œå› ä¸ºå½“å®ƒä»¬é‡åˆ°ç¬¬ä¸€ä¸ªNULå­—èŠ‚æ—¶å°†åœæ­¢å·¥ä½œã€‚
- ä½¿ç”¨**å†…å­˜æ“ä½œå‡½æ•°**å¯ä»¥å¤„ç†ä»»æ„çš„å­—èŠ‚åºåˆ—

~~~shell
void *memcpy(void *dst, void const *src, size_t length);
void *memmove(void *dst, void const *src, size_t length);
void *memcmp(void const *a, void const *b, size_t length);
void *memchr(void const *a, int ch, size_t length);
void *memset(void *a, int ch, size_t length);
~~~

- å’Œå­—ç¬¦æ“ä½œå‡½æ•°ç±»ä¼¼ï¼Œå¯¹äºmemcpy()å‡½æ•°ï¼Œå¦‚æœsrcä¸dstä»¥ä»»ä½•å½¢å¼å‡ºç°äº†é‡å ï¼Œå®ƒçš„ç»“æœæ˜¯æœªå®šä¹‰çš„ã€‚ä½†æ˜¯memmove()å‡½æ•°å¯ä»¥é‡å ã€‚
- å†…å­˜æ“ä½œå‡½æ•°ä¼ å…¥çš„é•¿åº¦ä¸ºå†…å­˜é•¿åº¦ä¸æ˜¯å…ƒç´ é•¿åº¦ã€‚
- ä»»ä½•ç±»å‹çš„æŒ‡é’ˆéƒ½å¯ä»¥è½¬æ¢ä¸º`void*`å‹æŒ‡é’ˆã€‚

`memcpy`

`memcpy` copies a block of memory from a source to a destination location.

**Parameters:**

- `dest`: A pointer to the destination memory block.
- `src`: A pointer to the source memory block.
- `n`: The number of bytes to copy

**Use case:** Copying data between non_overlapping memory regions.

~~~shell
#include <stdio.h>
#include <string.h>

int main(void)
{
  int source_array[] = {1,2,3,4,5};
  int destinaion_array[5];
  
  // copy 5 integers from soure_array to destination_array
  memcpy(destination_array, source_array, sizeof(source_array));

  printf("Destinaion array: ");
  for (int i = 0; i < 5; i++)
  {
    printf("%d ",destination_array[i]);
  }
  printf("\n");
  return 0;
}
~~~

`memmove`

`memmove` copies a block of memory from a source location to a destination location, even if the memory blocks overlap.

**Parameters:** Same as `memcpy`

**Use case:** Shifting data within the same array or buffer. This is safer than `memcpy` for overlapping regions.

~~~shell
#include <stdio.h>
#include <string.h>

int main(void)
{
  char str[] = "abcdefgh";
  
  // Shift the string two characters to the left
  // The source and destination overlap (str + 2 and str)
  memmove(str, str + 2,strlen(str) - 2);
  
  // manually add the null terminator since memmove doesn't
  str[strlen(str) - 2] = '\0';
  printf("String after memmove: %s\n", str); // prints "cdefgh"

  return 0;

}
~~~

`memchr`

`memchr` search a block of memory for the first occurrence of a specific byte.

**Parameters:**

- `a`: A pointer to the memory block to search
- `ch`: The byte value to search for. It's passed as an `int` but is treated as an `unsigned char`.
- `length`: The number of bytes to search.

**Return Value:**

- A pointer to the first occurrence of the byte `ch` within the first `n` bytes of the memory block `a`.
- A null pointer (`NULL`) if the byte is not found.

**Use Case:** Searching for a specific byte within a block of raw binary data.Unlike string functions like `strchr`. `memchr` continues its search past null terminators (`\0`).

~~~shell
#include <stdio.h>
#include <string.h>

int main(void) {
  // This array contains a null byte in the middle.
  char data[] = {'h', 'e', 'l', 'l', 'o', '\0', 'w', 'o', 'r', 'l', 'd'};
  char *result;
- 
  // Search for the character 'o' within the first 11 bytes of the array.
  // A string search function like strchr would stop at the '\0'
  result = memchr(data, 'o', sizeof(data));
  if (result != NULL) {
    printf("Found 'o' at memory address: %p\n", result);
    printf("Character found: '%c'\n", *result);

    // Calculate the index of the found character
    size_t index = (size_t)(result - data);
    printf("It is located at index: %zu\n", index);
  } else {
    printf("The character was not found.\n");
  }
  return 0;
}
~~~

`memcmp`

`memcmp` compares a specified number of bytes in two memory blocks

**Parameter:**

- `a`: A pointer to the first memory block
- `b`: A pointer to the second memory block
- `length`: The number of bytes to compare.

**Use case:** Comparing raw binary data, which may contain null bytes that would terminate string functions like `strcmp`.

~~~shell
#include <stdio.h>
#include <string.h>

int main(void)
{
  char data1[] = "Hello";
  char data2[] = "HellO";
  char data3[] = "Hello";
  
  // compare the first 5 bytes of data1 and data2
  int result1 = memcmp(data1, data2, 5);
  if (result1 != 0)
  {
    printf("data1 and data2 are different.\n");
  }
  // compare the first 5 bytes of data1 and data2
  
  int result2 = memcmp(data1, data3, 5);
  if(result2 != 0)
  {
    printf("data1 and data3 are different.\n");
  }
  return 0;
}
~~~

`memset`

`memset` fills a block of memory with a specified byte value.

**Parameters:**

- `a`: A pointer to the memory block to fill.
- `ch`: The value to be set. It's passed as an `int` but is converted to an `unsigned char`.
- `length`: The number of bytes to fill.

**Use case:** Initializing a block of memory, such as an array or a structure, to all zeros or a specific value.

~~~shell
#include <stdio.h>
#include <string.h>

int main(void)
{
  char buffer[10];
  
  // Initialize all 10 bytes of the buffer to 'A'
  memset(buffer, 'A', sizeof(buffer));
  printf("Buffer after memset: %.10s\n",buffer);
  
  // Initialize the buffer to all zeros (a common and safe practice)
  memset(buffer, 0, sizeof(buffer));
  printf("Buffer after zeroing: %d\n", buffer[0]); // Prints 0

  return 0;
}
~~~

## 9.10 æ€»ç»“

- å­—ç¬¦ä¸²å°±æ˜¯é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦çš„åºåˆ—ï¼Œè¯¥åºåˆ—ä»¥ä¸€ä¸ªNULå­—èŠ‚ç»“å°¾ã€‚

## 9.13 é—®é¢˜

1. Cè¯­è¨€ç¼ºå°‘æ˜¾å¼å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œè¿™æ˜¯ä¸€ä¸ªä¼˜ç‚¹è¿˜æ˜¯ä¸€ä¸ªç¼ºç‚¹ï¼Ÿ

Answer:

Cè¯­è¨€ç¼ºå°‘æ˜¾å¼çš„å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œæ—¢æ˜¯å®ƒçš„**ä¼˜ç‚¹**ï¼Œä¹Ÿæ˜¯å®ƒçš„**ç¼ºç‚¹**ã€‚  

ä¼˜ç‚¹ï¼šçµæ´»æ€§å’Œé«˜æ•ˆæ€§

Cè¯­è¨€çš„å­—ç¬¦ä¸²è¢«å®ç°ä¸ºä»¥ **ç©ºå­—ç¬¦ï¼ˆ\0ï¼‰** ç»“å°¾çš„å­—ç¬¦æ•°ç»„ï¼Œè¿™å¸¦æ¥äº†ä»¥ä¸‹å‡ ä¸ªæ˜¾è‘—çš„ä¼˜ç‚¹ï¼š

- å†…å­˜æ•ˆç‡é«˜ï¼šCè¯­è¨€çš„å­—ç¬¦ä¸²å­˜å‚¨éå¸¸ç´§å‡‘ï¼Œæ²¡æœ‰é¢å¤–çš„å…ƒæ•°æ®ï¼ˆå¦‚é•¿åº¦ä¿¡æ¯ï¼‰ã€‚è¿™ä½¿å¾—Cè¯­è¨€ç¨‹åºåœ¨å¤„ç†å¤§é‡æ–‡æœ¬æ—¶ï¼Œå†…å­˜å¼€é”€æå°ã€‚

- ç›´æ¥æ“ä½œå†…å­˜ï¼šå­—ç¬¦ä¸²ä½œä¸ºæ•°ç»„ï¼Œå¯ä»¥åƒæ™®é€šæ•°ç»„ä¸€æ ·é€šè¿‡æŒ‡é’ˆç›´æ¥è®¿é—®å’Œæ“ä½œæ¯ä¸ªå­—ç¬¦ã€‚è¿™ç»™äºˆäº†ç¨‹åºå‘˜æå¤§çš„çµæ´»æ€§ï¼Œå¯ä»¥å®ç°å„ç§é«˜æ•ˆçš„ç®—æ³•ï¼Œä¾‹å¦‚åŸåœ°ä¿®æ”¹ã€é›¶æ‹·è´ï¼ˆzero-copyï¼‰ç­‰ã€‚è¿™åœ¨ç³»ç»Ÿç¼–ç¨‹ã€åµŒå…¥å¼å¼€å‘å’Œæ€§èƒ½å…³é”®çš„åº”ç”¨ä¸­è‡³å…³é‡è¦ã€‚

- äº’æ“ä½œæ€§å¼ºï¼šå‡ ä¹æ‰€æœ‰ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒå­—èŠ‚æ•°ç»„æˆ–æŒ‡é’ˆï¼Œè¿™ä½¿å¾—Cè¯­è¨€çš„å­—ç¬¦ä¸²å¯ä»¥è½»æ¾åœ°ä¸å…¶ä»–è¯­è¨€ï¼ˆå¦‚Pythonã€Rustã€Javaç­‰ï¼‰è¿›è¡Œæ¥å£äº¤äº’ï¼Œè€Œæ— éœ€å¤æ‚çš„ç±»å‹è½¬æ¢ã€‚

ç¼ºç‚¹ï¼šå®‰å…¨æ€§å’Œæ˜“ç”¨æ€§

è¿™ç§è®¾è®¡ä¹Ÿå¸¦æ¥äº†æ˜æ˜¾çš„ç¼ºç‚¹ï¼Œå°¤å…¶æ˜¯åœ¨å®‰å…¨å’Œæ˜“ç”¨æ–¹é¢ï¼š

- å®‰å…¨æ€§é£é™©ï¼šç”±äºå­—ç¬¦ä¸²çš„é•¿åº¦ä¿¡æ¯ä¸æ˜¯æ˜¾å¼å­˜å‚¨çš„ï¼Œå­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼ˆå¦‚ strcpyã€strcatã€sprintfï¼‰éƒ½å‡å®šç›®æ ‡ç¼“å†²åŒºè¶³å¤Ÿå¤§ï¼Œè¿™ææ˜“å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚è¿™æ˜¯Cè¯­è¨€é•¿æœŸä»¥æ¥é¢ä¸´çš„æœ€å¤§å®‰å…¨æŒ‘æˆ˜ä¹‹ä¸€ã€‚ç¨‹åºå‘˜å¿…é¡»æ‰‹åŠ¨è·Ÿè¸ªå­—ç¬¦ä¸²é•¿åº¦ï¼Œå¦åˆ™ä¼šå¼•å‘ä¸¥é‡çš„æ¼æ´ã€‚

- å®¹æ˜“å‡ºé”™ï¼šå¿˜è®°åœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ  \0ï¼Œæˆ–ä¸å°å¿ƒè¦†ç›–äº†å®ƒï¼Œéƒ½ä¼šå¯¼è‡´ç¨‹åºè¯»å–åˆ°æ— æ•ˆå†…å­˜ï¼Œå¼•å‘æœªå®šä¹‰è¡Œä¸ºã€‚åˆå­¦è€…ç»å¸¸ä¼šå› ä¸ºè¿™äº›é—®é¢˜è€Œæ„Ÿåˆ°å›°æƒ‘ã€‚

- æ“ä½œä¸ä¾¿ï¼šå­—ç¬¦ä¸²çš„æ‹¼æ¥ã€æˆªå–ç­‰æ“ä½œä¸åƒé«˜çº§è¯­è¨€é‚£æ ·ç®€æ´ã€‚ä¾‹å¦‚ï¼Œè¦æ‹¼æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œä½ éœ€è¦æ‰‹åŠ¨è®¡ç®—æ‰€éœ€ç©ºé—´ã€åˆ†é…å†…å­˜ã€ç„¶åä½¿ç”¨ strcpy å’Œ strcatï¼Œæ•´ä¸ªè¿‡ç¨‹ç¹çä¸”å®¹æ˜“å‡ºé”™ã€‚
